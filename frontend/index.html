<!DOCTYPE html>
<html lang="es">
<head>
    <!-- ========================================================= -->
    <!-- 1. CONFIGURACIÓN BÁSICA DEL DOCUMENTO                     -->
    <!--    - Codificación, viewport y título                      -->
    <!-- ========================================================= -->

    <!-- [1.1] Configuración de codificación en UTF-8
         - Asegura que tildes, ñ y símbolos de moneda se vean bien. -->
    <meta charset="UTF-8">

    <!-- [1.2] Viewport para PWA responsive en móviles, tablets y desktop
         - width=device-width: ajusta el ancho al del dispositivo.
         - initial-scale=1.0: zoom inicial.
         - maximum-scale=1.0: evita zoom accidental en POS.
         - viewport-fit=cover: usa toda el área útil (notch, etc.). -->
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover"
    >

    <!-- [1.3] Título de la app
         - Aparece en la pestaña del navegador y en algunos contextos PWA. -->
    <title>Finance PWA · Asistente Financiero para Negocios de Comida</title>


    <!-- ========================================================= -->
    <!-- 2. SEO BÁSICO (PORQUE TU APP ES PÚBLICA)                  -->
    <!--    - Descripción, keywords y autor                        -->
    <!-- ========================================================= -->

    <!-- [2.1] Descripción corta de la app
         - Útil para buscadores y cuando se previsualiza en algunos sitios. -->
    <meta
        name="description"
        content="Finance PWA es un asistente financiero avanzado para negocios de comida. Calcula costos reales, ganancias, metas y flujo de caja por producto, venta y periodo de tiempo."
    >

    <!-- [2.2] Palabras clave
         - No es crítico hoy en día, pero ayuda a contextualizar el proyecto. -->
    <meta
        name="keywords"
        content="PWA, finanzas, negocios de comida, restaurante, costos, ganancias, metas, flujo de caja, POS"
    >

    <!-- [2.3] Autor / marca del proyecto -->
    <meta name="author" content="Finance PWA">


    <!-- ========================================================= -->
    <!-- 3. PWA: MANIFEST + CAPACIDAD DE APP                       -->
    <!--    - Hace que el navegador trate tu web como aplicación   -->
    <!-- ========================================================= -->

    <!-- [3.1] Enlace al manifest de la PWA
         - IMPORTANTE: en tu estructura, manifest.json está en /static/manifest.json
         - Flask debe servir correctamente /static/ para que esto funcione. -->
    <link rel="manifest" href="/static/manifest.json">

    <!-- [3.2] mobile-web-app-capable
         - Le indica a navegadores (especialmente Android/Chrome) que puede
           comportarse como una app cuando se “añade a pantalla de inicio”. -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- [3.3] Color principal de la app
         - Barra del navegador en móviles y algunos contextos de sistema. -->
    <meta name="theme-color" content="#111111">


    <!-- ========================================================= -->
    <!-- 4. ICONOS / FAVICONS (BASADO EN TU /static/icons)          -->
    <!--    - Iconos para navegador, PWA y Apple                    -->
    <!-- ========================================================= -->

    <!-- [4.1] Favicon / icono base (navegadores modernos) -->
    <link
        rel="icon"
        type="image/png"
        sizes="192x192"
        href="/static/icons/icon-192.png"
    >

    <!-- [4.2] Icono grande para PWA (Android / desktop) -->
    <link
        rel="icon"
        type="image/png"
        sizes="512x512"
        href="/static/icons/icon-512.png"
    >

    <!-- Agregar después de [4.2] -->

    <!-- [4.2.1] Favicons adicionales para mejor compatibilidad -->
    <link rel="icon" type="image/png" sizes="32x32" href="/static/icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/icons/icon-16.png">
    <link rel="shortcut icon" href="/static/favicon.ico">

    <!-- [4.7] Microsoft Tiles (Windows) -->
    <meta name="msapplication-TileColor" content="#111111">
    <meta name="msapplication-TileImage" content="/static/icons/icon-144.png">

    <!-- Agregar en sección [8] - Descomentar si usas API externa -->
    <link rel="dns-prefetch" href="https://api.finance.ejemplo.com">

    <!-- [4.3] Icono para iOS/iPadOS al añadir a pantalla de inicio -->
    <link
        rel="apple-touch-icon"
        href="/static/icons/icon-192.png"
    >

    <!-- [4.4] Permite modo "web app" en iOS (sin barra de navegador) -->
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- [4.5] Título que verá el usuario cuando la app esté instalada en iOS -->
    <meta name="apple-mobile-web-app-title" content="Finance PWA">

    <!-- [4.6] Estilo de barra de estado en iOS (negro translúcido queda bien con tema oscuro) -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">


    <!-- ========================================================= -->
    <!-- 5. METADATOS SOCIALES (OPEN GRAPH + TWITTER)               -->
    <!--    - Para previews bonitas en WhatsApp / X / Facebook      -->
    <!--    - Ajusta dominio e imagen cuando tengas brand final     -->
    <!-- ========================================================= -->

    <!-- [5.1] Open Graph básico -->
    <meta property="og:type" content="website">
    <meta
        property="og:title"
        content="Finance PWA · Asistente Financiero para Negocios de Comida"
    >
    <meta
        property="og:description"
        content="Analiza tu negocio de comida con precisión: costos reales, ventas, metas y flujo de caja en una PWA offline-first."
    >
    <!-- [5.2] URL pública principal de tu app (ajusta a tu dominio real) -->
    <meta property="og:url" content="https://finance.ejemplo.com/">

    <!-- [5.3] Imagen de previsualización
         - Por ahora usamos splash.png como cover; luego puedes cambiarla. -->
    <meta
        property="og:image"
        content="https://finance.ejemplo.com/static/icons/splash.png"
    >

    <!-- [5.4] Twitter Card (X) básica -->
    <meta name="twitter:card" content="summary_large_image">
    <meta
        name="twitter:title"
        content="Finance PWA · Asistente Financiero para Negocios de Comida"
    >
    <meta
        name="twitter:description"
        content="PWA inteligente para dueños de negocios de comida. Calcula costos, ganancias y metas de forma visual y detallada."
    >
    <meta
        name="twitter:image"
        content="https://finance.ejemplo.com/static/icons/splash.png"
    >


    <!-- ========================================================= -->
    <!-- 6. MEJORAS PARA EXPERIENCIA EN MÓVIL                      -->
    <!-- ========================================================= -->

    <!-- [6.1] Evita que el navegador convierta números en links de teléfono -->
    <meta name="format-detection" content="telephone=no">

    <!-- [6.2] (Opcional) Indicar idioma principal de contenido al navegador
         - El atributo lang real va en <html>, esto es solo informativo extra. -->
    <meta http-equiv="Content-Language" content="es">


    <!-- ========================================================= -->
    <!-- 7. HOJAS DE ESTILO (CSS) SEGÚN TU ESTRUCTURA              -->
    <!--    - index.html vive en /frontend                          -->
    <!--    - Por eso las rutas son relativas: css/...              -->
    <!-- ========================================================= -->

    <!-- [7.1] Estilos base: reset, tipografías, utilidades globales -->
    <link rel="stylesheet" href="css/base.css">

    <!-- [7.2] Layout tipo POS: header, sidebar, main, grids -->
    <link rel="stylesheet" href="css/layout.css">

    <!-- [7.3] Estilos para formularios (onboarding, blocks, products, sales, etc.) -->
    <link rel="stylesheet" href="css/forms.css">

    <!-- [7.4] Estilos específicos para contenedores de gráficos, tarjetas de analytics -->
    <link rel="stylesheet" href="css/charts.css">

    <!-- [7.5] Tema oscuro por defecto (luego puedes alternar tema con JS) -->
    <link rel="stylesheet" href="css/theme-dark.css">


    <!-- ========================================================= -->
    <!-- 8. PISTAS DE PERFORMANCE (OPCIONALES, PREPARADAS)          -->
    <!--    - Puedes descomentar cuando las necesites               -->
    <!-- ========================================================= -->

    <!-- [8.1] (Opcional futuro) Preconexión a servidor de API propio
         - Útil si más adelante expones un subdominio tipo api.finance.ejemplo.com
         - De momento lo dejo comentado para que no moleste.

    <link rel="preconnect" href="https://api.finance.ejemplo.com" crossorigin>
    -->

    <!-- [8.2] (Opcional futuro) Preconexión a Google Fonts u otro CDN
         - Solo si realmente usas fuentes externas.
         
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    -->


    <!-- ========================================================= -->
    <!-- 9. SCRIPT PRINCIPAL DEL FRONTEND (ENTRYPOINT JS)           -->
    <!--    - SOLO cargamos main.js aquí                            -->
    <!--    - main.js importará el resto de módulos JS              -->
    <!-- ========================================================= -->

    <!-- [9.1] Script de entrada de la PWA
         - type="module" permite usar imports ES6.
         - Ruta relativa: index.html está en /frontend → js/main.js en /frontend/js/main.js
         - main.js será responsable de:
             * registrar el Service Worker (static/sw.js),
             * inicializar Socket.IO (cuando lo conectes),
             * llamar a initApp() de index.js,
             * inicializar router, state, syncEngine, etc. -->
    <script type="module" src="js/main.js"></script>

</head>
<body data-theme="dark" data-connection="online" data-sync-state="idle" data-view="loading">

    <!-- ========================================================= -->
    <!-- CAPA 1: APP SHELL (ESTRUCTURA FIJA)                       -->
    <!--         - Header, Sidebar, Main View                      -->
    <!--         - Esta estructura NUNCA cambia                    -->
    <!-- ========================================================= -->
    
    <!-- [1.1] HEADER PRINCIPAL
         - Barra superior fija (position: sticky)
         - Logo, búsqueda global, notificaciones, perfil
         - Controlado por: ui_layout.js
         - Responsive: se colapsa en mobile con hamburger menu -->
    <header id="app-header" class="app-header" role="banner">
        <div class="header-container">
            <!-- [1.1.1] Logo y toggle del sidebar -->
            <div class="header-brand">
                <button 
                    type="button" 
                    id="sidebar-toggle" 
                    class="btn-icon" 
                    aria-label="Abrir menú"
                    aria-expanded="false"
                    aria-controls="app-sidebar"
                    data-event="toggle-sidebar"
                >
                    <svg width="24" height="24">
                        <use href="#icon-menu"></use>
                    </svg>
                </button>
                
                <h1 class="brand-logo">
                    <img src="/static/icons/icon-192.png" alt="Finance PWA" width="32" height="32">
                    <span class="brand-text">Finance PWA</span>
                </h1>
            </div>
            
            <!-- [1.1.2] Búsqueda global (expandible en mobile) -->
            <div class="header-search">
                <button 
                    type="button" 
                    id="search-toggle" 
                    class="btn-icon btn-search-mobile"
                    aria-label="Buscar"
                    data-event="toggle-search"
                >
                    <svg width="20" height="20">
                        <use href="#icon-search"></use>
                    </svg>
                </button>
                
                <div id="search-bar" class="search-bar" role="search">
                    <svg class="search-icon" width="20" height="20">
                        <use href="#icon-search"></use>
                    </svg>
                    <input 
                        type="search" 
                        id="global-search" 
                        class="search-input" 
                        placeholder="Buscar ventas, productos, bloques..."
                        aria-label="Buscar en Finance PWA"
                        autocomplete="off"
                    >
                    <button 
                        type="button" 
                        id="search-clear" 
                        class="btn-icon-small"
                        aria-label="Limpiar búsqueda"
                        hidden
                    >
                        <svg width="16" height="16">
                            <use href="#icon-x"></use>
                        </svg>
                    </button>
                </div>
                
                <!-- Resultados de búsqueda (dropdown) -->
                <div id="search-results" class="search-results" role="listbox" hidden></div>
            </div>
            
            <!-- [1.1.3] Acciones del header (notificaciones, perfil) -->
            <div class="header-actions">
                <!-- Sincronización manual -->
                <button 
                    type="button" 
                    id="sync-trigger" 
                    class="btn-icon"
                    aria-label="Sincronizar datos"
                    data-event="manual-sync"
                    data-sync-state="idle"
                >
                    <svg width="20" height="20">
                        <use href="#icon-refresh"></use>
                    </svg>
                </button>
                
                <!-- Notificaciones -->
                <button 
                    type="button" 
                    id="notifications-btn" 
                    class="btn-icon"
                    aria-label="Notificaciones"
                    aria-haspopup="true"
                    data-count="0"
                >
                    <svg width="20" height="20">
                        <use href="#icon-bell"></use>
                    </svg>
                    <span id="notifications-badge" class="badge" hidden>0</span>
                </button>
                
                <!-- Menú de usuario -->
                <button 
                    type="button" 
                    id="user-menu-btn" 
                    class="btn-icon user-avatar"
                    aria-label="Menú de usuario"
                    aria-haspopup="true"
                    aria-expanded="false"
                >
                    <svg width="24" height="24">
                        <use href="#icon-user"></use>
                    </svg>
                </button>
            </div>
        </div>
    </header>
    
    <!-- [1.2] SIDEBAR / NAVEGACIÓN PRINCIPAL
         - Menú lateral con navegación a todas las vistas
         - Colapsable en mobile/tablet
         - Controlado por: ui_layout.js, router.js
         - Atributos: data-collapsed (true/false) -->
    <aside 
        id="app-sidebar" 
        class="app-sidebar" 
        role="navigation" 
        aria-label="Navegación principal"
        data-collapsed="false"
    >
        <nav class="sidebar-nav">
            <ul class="nav-list" role="list">
                <!-- [1.2.1] Dashboard -->
                <li class="nav-item">
                    <a 
                        href="#/dashboard" 
                        class="nav-link active" 
                        data-route="dashboard"
                        aria-current="page"
                    >
                        <svg class="nav-icon" width="20" height="20">
                            <use href="#icon-home"></use>
                        </svg>
                        <span class="nav-text">Dashboard</span>
                    </a>
                </li>
                
                <!-- [1.2.2] Ventas / POS -->
                <li class="nav-item">
                    <a 
                        href="#/sales" 
                        class="nav-link" 
                        data-route="sales"
                    >
                        <svg class="nav-icon" width="20" height="20">
                            <use href="#icon-dollar"></use>
                        </svg>
                        <span class="nav-text">Ventas</span>
                    </a>
                </li>
                
                <!-- [1.2.3] Productos -->
                <li class="nav-item">
                    <a 
                        href="#/products" 
                        class="nav-link" 
                        data-route="products"
                    >
                        <svg class="nav-icon" width="20" height="20">
                            <use href="#icon-package"></use>
                        </svg>
                        <span class="nav-text">Productos</span>
                    </a>
                </li>
                
                <!-- [1.2.4] Bloques -->
                <li class="nav-item">
                    <a 
                        href="#/blocks" 
                        class="nav-link" 
                        data-route="blocks"
                    >
                        <svg class="nav-icon" width="20" height="20">
                            <use href="#icon-layers"></use>
                        </svg>
                        <span class="nav-text">Bloques</span>
                    </a>
                </li>
                
                <!-- [1.2.5] Metas -->
                <li class="nav-item">
                    <a 
                        href="#/goals" 
                        class="nav-link" 
                        data-route="goals"
                    >
                        <svg class="nav-icon" width="20" height="20">
                            <use href="#icon-target"></use>
                        </svg>
                        <span class="nav-text">Metas</span>
                    </a>
                </li>
                
                <!-- [1.2.6] Analytics -->
                <li class="nav-item">
                    <a 
                        href="#/analytics" 
                        class="nav-link" 
                        data-route="analytics"
                    >
                        <svg class="nav-icon" width="20" height="20">
                            <use href="#icon-bar-chart"></use>
                        </svg>
                        <span class="nav-text">Analytics</span>
                    </a>
                </li>
                
                <!-- [1.2.7] Recibos -->
                <li class="nav-item">
                    <a 
                        href="#/receipts" 
                        class="nav-link" 
                        data-route="receipts"
                    >
                        <svg class="nav-icon" width="20" height="20">
                            <use href="#icon-file-text"></use>
                        </svg>
                        <span class="nav-text">Recibos</span>
                    </a>
                </li>
                
                <!-- [1.2.8] Actividad -->
                <li class="nav-item">
                    <a 
                        href="#/activity" 
                        class="nav-link" 
                        data-route="activity"
                    >
                        <svg class="nav-icon" width="20" height="20">
                            <use href="#icon-activity"></use>
                        </svg>
                        <span class="nav-text">Actividad</span>
                    </a>
                </li>
                
                <!-- [1.2.9] Configuración -->
                <li class="nav-item nav-item-bottom">
                    <a 
                        href="#/settings" 
                        class="nav-link" 
                        data-route="settings"
                    >
                        <svg class="nav-icon" width="20" height="20">
                            <use href="#icon-settings"></use>
                        </svg>
                        <span class="nav-text">Configuración</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <!-- [1.2.10] Footer del sidebar con info de sincronización -->
        <div class="sidebar-footer">
            <div class="sync-status" data-sync-state="idle">
                <svg class="sync-icon" width="16" height="16">
                    <use href="#icon-check-circle"></use>
                </svg>
                <span class="sync-text">Sincronizado</span>
            </div>
        </div>
    </aside>
    
    <!-- [1.3] MAIN VIEW CONTAINER
         - Contenedor principal donde router.js renderiza las vistas
         - Cada vista es una <section> con data-view="nombre"
         - Solo una vista visible a la vez (class="active") -->
    <main 
        id="app-main" 
        class="app-main" 
        role="main"
    >
        <!-- Las vistas se renderizan aquí dinámicamente -->
        <!-- Estructura inyectada por router.js y módulos ui_*.js -->
    </main>


    <!-- ========================================================= -->
    <!-- CAPA 2: VIEWS (PANTALLAS/MÓDULOS INTERNOS)                -->
    <!--         - Se cargan bajo demanda en #app-main            -->
    <!--         - Controladas por router.js                       -->
    <!-- ========================================================= -->
    
    <!-- NOTA: Las vistas NO se pre-renderizan aquí.
         Se crean dinámicamente por los módulos ui_*.js cuando el usuario
         navega a cada ruta. Aquí solo documentamos la estructura esperada.
         
         Vistas que router.js puede cargar:
         - #onboarding-view   (ui_onboarding.js)
         - #dashboard-view    (ui_layout.js)
         - #sales-view        (ui_sales.js)
         - #products-view     (ui_products.js)
         - #blocks-view       (ui_blocks.js)
         - #goals-view        (ui_goals.js)
         - #analytics-view    (ui_analytics.js)
         - #receipts-view     (ui_receipts.js)
         - #activity-view     (ui_activity.js)
         - #settings-view     (ui_layout.js)
         
         Cada vista tiene esta estructura base:
         <section id="[nombre]-view" class="view" data-view="[nombre]">
             <div class="view-header">
                 <h2 class="view-title">Título</h2>
                 <div class="view-actions">Botones</div>
             </div>
             <div class="view-content">
                 Contenido específico de la vista
             </div>
         </section>
    -->


    <!-- ========================================================= -->
    <!-- CAPA 3: MODALES (DIÁLOGOS Y FORMULARIOS EMERGENTES)       -->
    <!--         - Contenedor global para todos los modales       -->
    <!-- ========================================================= -->
    
    <!-- [3.1] Contenedor de modales
         - Portal donde se inyectan todos los modales de la app
         - ui_layout.js expone: showModal(), hideModal(), destroyModal()
         - z-index: 1000 (por encima de todo el contenido)
         - aria-live="polite" para accesibilidad -->
    <div 
        id="modal-container" 
        class="modal-container" 
        aria-live="polite"
    >
        <!-- Los modales se crean dinámicamente aquí
        
        Ejemplos de modales comunes:
        - Confirmación de eliminar venta
        - Formulario de nuevo producto
        - Detalle de transacción
        - Selector de fecha/rango
        - Editor de bloque
        - Configuración de meta
        - Visor de recibo
        
        Estructura típica de un modal:
        <div class="modal-overlay" data-modal-id="confirm-delete">
            <div class="modal-dialog" role="dialog" aria-modal="true">
                <div class="modal-header">
                    <h3 class="modal-title">¿Eliminar venta?</h3>
                    <button class="modal-close" aria-label="Cerrar">×</button>
                </div>
                <div class="modal-body">
                    <p>Esta acción no se puede deshacer.</p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary">Cancelar</button>
                    <button class="btn btn-danger">Eliminar</button>
                </div>
            </div>
        </div>
        -->
    </div>


    <!-- ========================================================= -->
    <!-- CAPA 4: TOASTS (NOTIFICACIONES TEMPORALES)                -->
    <!--         - Feedback visual no invasivo al usuario          -->
    <!-- ========================================================= -->
    
    <!-- [4.1] Contenedor de toasts
         - Posicionado en esquina (top-right por defecto)
         - Auto-dismiss en 3-5 segundos
         - Apilamiento vertical
         - Controlado por: telemetry.js o módulo de notificaciones
         - Tipos: success, error, warning, info -->
    <div 
        id="toast-container" 
        class="toast-container" 
        aria-live="assertive"
        aria-atomic="true"
        role="status"
    >
        <!-- Los toasts se generan dinámicamente aquí
        
        Ejemplos de toasts:
        - "Venta registrada correctamente" (success)
        - "Error al sincronizar datos" (error)
        - "Stock bajo en producto X" (warning)
        - "Meta alcanzada: $1000" (info)
        
        Estructura típica:
        <div class="toast toast-success" data-toast-id="12345">
            <svg class="toast-icon" width="20" height="20">
                <use href="#icon-check-circle"></use>
            </svg>
            <div class="toast-content">
                <strong class="toast-title">¡Éxito!</strong>
                <p class="toast-message">Venta registrada correctamente</p>
            </div>
            <button class="toast-close" aria-label="Cerrar">×</button>
        </div>
        -->
    </div>


    <!-- ========================================================= -->
    <!-- CAPA 5: OVERLAYS / ESTADOS ESPECIALES                     -->
    <!--         - Pantallas de carga, banners offline, etc.       -->
    <!-- ========================================================= -->
    
    <!-- [5.1] Banner de estado offline
         - Aparece sticky en top cuando navigator.onLine === false
         - syncEngine.js lo muestra/oculta automáticamente
         - Oculto por defecto (hidden attribute) -->
    <div 
        id="offline-banner" 
        class="banner banner-offline" 
        role="alert"
        aria-live="polite"
        hidden
    >
        <div class="banner-content">
            <svg class="banner-icon" width="20" height="20">
                <use href="#icon-wifi-off"></use>
            </svg>
            <span class="banner-text">
                Modo offline - Los cambios se sincronizarán automáticamente
            </span>
        </div>
        <button 
            type="button" 
            class="banner-close" 
            aria-label="Cerrar banner"
            data-event="dismiss-offline-banner"
        >
            <svg width="16" height="16">
                <use href="#icon-x"></use>
            </svg>
        </button>
    </div>
    
    <!-- [5.2] Banner de sincronización en progreso
         - Aparece cuando syncEngine.js está sincronizando
         - Muestra contador de elementos pendientes
         - Se oculta automáticamente al completar -->
    <div 
        id="sync-banner" 
        class="banner banner-sync" 
        role="status"
        aria-live="polite"
        hidden
    >
        <div class="banner-content">
            <svg class="banner-icon spinner" width="20" height="20">
                <use href="#icon-loader"></use>
            </svg>
            <span class="banner-text">
                Sincronizando 
                <strong id="sync-count">0</strong> 
                cambios pendientes...
            </span>
        </div>
    </div>
    
    <!-- [5.3] Loader inicial (Splash Screen)
         - Cubre toda la pantalla durante bootstrap
         - main.js lo oculta después de:
             * Registrar Service Worker
             * Inicializar IndexedDB
             * Cargar configuración
             * Renderizar primera vista
         - Transición fade out (0.3s) -->
    <div 
        id="app-loader" 
        class="loader-overlay"
        aria-busy="true"
        aria-label="Cargando Finance PWA"
    >
        <div class="loader-content">
            <!-- Logo de la app -->
            <img 
                src="/static/icons/icon-192.png" 
                alt="Finance PWA" 
                class="loader-logo"
                width="80" 
                height="80"
            >
            
            <!-- Spinner animado -->
            <div class="spinner" role="progressbar"></div>
            
            <!-- Texto de estado (actualizado por main.js) -->
            <p id="loader-text" class="loader-text">
                Iniciando Finance PWA...
            </p>
            
            <!-- Barra de progreso (opcional) -->
            <div class="progress-bar">
                <div 
                    id="loader-progress" 
                    class="progress-fill"
                    style="width: 0%"
                    role="progressbar"
                    aria-valuenow="0"
                    aria-valuemin="0"
                    aria-valuemax="100"
                ></div>
            </div>
        </div>
    </div>
    
    <!-- [5.4] Overlay de consentimiento/onboarding (primera visita)
         - Aparece en primera carga si no hay datos de onboarding
         - Bloqueante (no se puede cerrar sin completar)
         - Controlado por: ui_onboarding.js -->
    <div 
        id="onboarding-overlay" 
        class="overlay overlay-onboarding"
        role="dialog"
        aria-modal="true"
        aria-labelledby="onboarding-title"
        hidden
    >
        <!-- Contenido renderizado por ui_onboarding.js -->
    </div>


    <!-- ========================================================= -->
    <!-- SPRITES SVG (ICONOS REUTILIZABLES)                        -->
    <!--    - Definidos aquí para evitar requests HTTP             -->
    <!--    - Referenciados con: <use href="#icon-nombre">         -->
    <!-- ========================================================= -->
    
    <svg 
        xmlns="http://www.w3.org/2000/svg" 
        style="display: none;"
        aria-hidden="true"
    >
        <defs>
            <!-- Navegación -->
            <symbol id="icon-menu" viewBox="0 0 24 24">
                <path d="M3 12h18M3 6h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <symbol id="icon-home" viewBox="0 0 24 24">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" stroke="currentColor" stroke-width="2" fill="none"/>
            </symbol>
            
            <symbol id="icon-x" viewBox="0 0 24 24">
                <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <!-- Búsqueda -->
            <symbol id="icon-search" viewBox="0 0 24 24">
                <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <!-- Estados -->
            <symbol id="icon-check" viewBox="0 0 24 24">
                <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>
            </symbol>
            
            <symbol id="icon-check-circle" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
                <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>
            </symbol>
            
            <symbol id="icon-alert-circle" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
                <path d="M12 8v4M12 16h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <symbol id="icon-loader" viewBox="0 0 24 24">
                <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <!-- Conectividad -->
            <symbol id="icon-wifi-off" viewBox="0 0 24 24">
                <path d="M1 1l22 22M16.72 11.06A10.94 10.94 0 0 1 19 12.55M5 12.55a10.94 10.94 0 0 1 5.17-2.39M10.71 5.05A16 16 0 0 1 22.58 9M1.42 9a15.91 15.91 0 0 1 4.7-2.88M8.53 16.11a6 6 0 0 1 6.95 0M12 20h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <symbol id="icon-refresh" viewBox="0 0 24 24">
                <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2" stroke="currentColor" stroke-width="2" fill="none"/>
            </symbol>
            
            <!-- Usuario -->
            <symbol id="icon-user" viewBox="0 0 24 24">
                <circle cx="12" cy="8" r="5" stroke="currentColor" stroke-width="2" fill="none"/>
                <path d="M20 21a8 8 0 1 0-16 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>
            </symbol>
            
            <symbol id="icon-bell" viewBox="0 0 24 24">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>
            </symbol>
            
            <!-- Finanzas -->
            <symbol id="icon-dollar" viewBox="0 0 24 24">
                <path d="M12 1v22M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <symbol id="icon-target" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
                <circle cx="12" cy="12" r="6" stroke="currentColor" stroke-width="2" fill="none"/>
                <circle cx="12" cy="12" r="2" fill="currentColor"/>
            </symbol>
            
            <!-- Contenido -->
            <symbol id="icon-package" viewBox="0 0 24 24">
                <path d="M16.5 9.4l-9-5.19M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" stroke="currentColor" stroke-width="2" fill="none"/>
                <path d="M3.27 6.96L12 12.01l8.73-5.05M12 22.08V12" stroke="currentColor" stroke-width="2"/>
            </symbol>
            
            <symbol id="icon-layers" viewBox="0 0 24 24">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            </symbol>
            
            <symbol id="icon-bar-chart" viewBox="0 0 24 24">
                <path d="M12 20V10M18 20V4M6 20v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <symbol id="icon-file-text" viewBox="0 0 24 24">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2" fill="none"/>
                <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <symbol id="icon-activity" viewBox="0 0 24 24">
                <path d="M22 12h-4l-3 9L9 3l-3 9H2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            </symbol>
            
            <symbol id="icon-settings" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" fill="none"/>
                <path d="M12 1v6m0 6v10M1 12h6m6 0h10" stroke="currentColor" stroke-width="2"/>
            </symbol>
        </defs>
    </svg>

</body>
